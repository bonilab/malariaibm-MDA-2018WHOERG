install.packages("epiR")
writeLines('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', con = "~/.Renviron")
Sys.which("make")
Sys.which("make")
# p1 = ggscatter(d1, x = "bottle neck sizes", y = year,
#           add = "reg.line", conf.int = TRUE,
#           cor.coef = TRUE, cor.method = "pearson",
#           xlab = "Bottleneck Size", ylab = "580Y Freq at year 5
source("D:/Projects/psu/malariaibm-MDA-2018WHOERG/figures/main_figures/figure_6/bottle_neck_cor.R")
source("D:/Projects/psu/malariaibm-MDA-2018WHOERG/figures/main_figures/figure_6/bottle_neck_cor.R")
setwd("D:/Projects/psu/malariaibm-MDA-2018WHOERG/figures/main_figures/figure_6")
result = rename(result , c ("V1"="y2023","V2"= "y2024", "V3" = "y2025",
"V4" = "y2026","V5" = "y2027", "V6" = "y2028",
"V7" = "y2029","V8" = "y2030",
"V9" = "bottle neck sizes" ))
source("D:/Projects/psu/malariaibm-MDA-2018WHOERG/figures/main_figures/figure_6/bottle_neck_cor.R")
source("D:/Projects/psu/malariaibm-MDA-2018WHOERG/figures/main_figures/figure_6/bottle_neck_cor.R")
year = "y2030"
d1 = result[(result['bottle neck sizes'] <= 100) & (result[year] > 0.5), ]
d2 = result[(result['bottle neck sizes'] > 100) & (result[year] >  0.5), ]
d3 = result[(result['bottle neck sizes'] <= 100) & (result[year] <= 0.5), ]
d4 = result[(result['bottle neck sizes'] > 100) & (result[year] <= 0.5), ]
grob1 <- grobTree(textGrob(nrow(d1), x=0.1,  y=0.95, hjust=0,
gp=gpar(col="red", fontsize=16)))
grob2 <- grobTree(textGrob(nrow(d2), x=0.75,  y=0.95, hjust=0,
gp=gpar(col="red", fontsize=16)))
grob3 <- grobTree(textGrob(nrow(d3), x=0.1,  y=0.1, hjust=0,
gp=gpar(col="red", fontsize=16)))
grob4 <- grobTree(textGrob(nrow(d4), x=0.75,  y=0.1, hjust=0,
gp=gpar(col="red", fontsize=16)))
p3 = ggscatter(result, x = "bottle neck sizes", y = "y2030",
color = "black", shape = 20, size = 2,
add = "none",
# conf.int = TRUE, cor.coef = FALSE, cor.method = "pearson",
xlab = "Bottleneck Size", ylab = "580Y Freq at year 10", log="bottle neck sizes") +
xscale("log10") +
geom_vline(xintercept = 100, color="red", size = 1.5) +
geom_hline(yintercept = 0.5, color="red", size = 1.5) +
annotation_custom(grob1) +
annotation_custom(grob2) +
annotation_custom(grob3) +
annotation_custom(grob4)
ggarrange(p1+ rremove("xlab"), p2+ rremove("xlab"), p3, ncol = 1, nrow = 3,
common.legend = TRUE, legend = "bottom")
source("D:/Projects/psu/malariaibm-MDA-2018WHOERG/figures/main_figures/figure_6/bottle_neck_cor.R")
setwd("D:/Projects/psu/malariaibm-MDA-2018WHOERG/figures/main_figures/figure_6")
print(mda)
# read data ---------------------------------------------------------------
result =  data.frame()
source("D:/Projects/psu/malariaibm-MDA-2018WHOERG/figures/main_figures/figure_6/bottle_neck_cor.R", echo=TRUE)
source("D:/Projects/psu/malariaibm-MDA-2018WHOERG/figures/main_figures/figure_6/figure_6_prcc_2.R", echo=TRUE)
